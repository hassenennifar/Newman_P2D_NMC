function [kappa, dkappa] = fun_kappa(cl, P)

T = P.T;

kappa = cl/1e3/10 .* (-10.5 + 0.074*T - 6.96e-5*T^2 + 0.668*cl/1e3 ...
    - 0.0178*cl/1e3*T + 2.8e-5*cl/1e3*T^2 + 0.494*(cl/1e3).^2 ...
    - 8.86e-4*(cl/1e3).^2*T).^2;
    
dkappa = ((8264141345021879*T^2*cl)/295147905179352825856000 ...
    - (5135573550120739*T^2)/73786976294838206464 ...
    - (8171907624653331*T*cl.^2)/9223372036854775808000000 ...
    - (89*T*cl)/5000000 + (37*T)/500 + (247*cl.^2)/500000000 ...
    + (167*cl)/250000 - 21/2).^2/10000 + (cl.*((247*cl)/250000000 ...
    - (89*T)/5000000 - (8171907624653331*T*cl)/4611686018427387904000000 ...
    + (8264141345021879*T^2)/295147905179352825856000 ...
    + 167/250000).*((8264141345021879*T^2*cl)/295147905179352825856000 ...
    - (5135573550120739*T^2)/73786976294838206464 ...
    - (8171907624653331*T*cl.^2)/9223372036854775808000000 ...
    - (89*T*cl)/5000000 + (37*T)/500 + (247*cl.^2)/500000000 ...
    + (167*cl)/250000 - 21/2))/5000;

    